'''
Author: Sen Varghese
DS 602
Title: A cross tabulation analysis on factors that determine heart condition

'''
#Load data
library(readxl)
cleaveland_stats <- read_excel("C:/Users/Sen/Desktop/cleaveland_stats.xlsx")
View(cleaveland_stats)

#store dataframe data in variable
MyData <- cleaveland_stats

#Packages needed
#install.packages("vcd")
#install.packages("gmodels")

library(vcd) # Cramers V 
library(gmodels) #Crosstabs

#Histogram for all variables
hist(MyData$age, 
     main = 'Fig. 1 Histogram of Age' , 
     xlab = 'Value', col="darkgreen", 
     density = 20, 
     freq = FALSE)


hist(MyData$restBP, 
     main = 'Fig. 2 Histogram of restBP' , 
     xlab = 'Value', 
     col="darkgreen", 
     density = 20, 
     freq = FALSE)


hist(MyData$chol, 
     main = 'Fig. 3 Histogram of chol' , 
     xlab = 'Value', 
     col="darkgreen", 
     density = 20, 
     freq = FALSE)


hist(MyData$`heart rate`, 
     main = 'Fig. 4 Histogram of `heart rate`' , 
     xlab = 'Value', 
     col="darkgreen", 
     density = 20, 
     freq = FALSE)


hist(MyData$sex, 
     main = 'Fig. 5 Histogram of sex' , 
     xlab = 'Value', 
     breaks = 2, 
     col="darkgreen", 
     density = 10, 
     freq = FALSE)


hist(MyData$`Heart condition`, 
     main = 'Fig. 6 Histogram of `Heart condition`' , 
     xlab = 'Value', 
     breaks = 2, 
     col="darkgreen", 
     density = 10, 
     freq = FALSE)

  
# Binning numeric variables

ageGroup = cut(MyData$age,5)
restBP = cut(MyData$restBP,3)
cholestrol = cut(MyData$chol,3)
heartRate = cut(MyData$`heart rate`,3)

#Driscriptive Statistics

describe(MyData)
describe(ageGroup)
describe(restBP)
describe(cholestrol)
describe(heartRate)

# Cross tabulation

#1 ageGroup v Heart condition

table1 = CrossTable(ageGroup,MyData$`Heart condition`,
                    expected = TRUE, 
                    prop.r = FALSE,
                    prop.c = FALSE,
                    prop.t = FALSE,
                    prop.chisq = FALSE,
                    fisher = FALSE,
                    resid = TRUE, 
                    format = c('SPSS'))

assocstats(table(ageGroup,MyData$`Heart condition`))


#2 Blood Pressure at rest v Heart condition

table2 = CrossTable(restBP,MyData$`Heart condition`,
                    expected = TRUE, 
                    prop.r = FALSE,
                    prop.c = FALSE,
                    prop.t = FALSE,
                    prop.chisq = FALSE,
                    fisher = FALSE,
                    resid = TRUE, 
                    format = c('SPSS'))

assocstats(table(restBP,MyData$`Heart condition`))


#3 cholestrol at rest v Heart condition

table3 = CrossTable(cholestrol,MyData$`Heart condition`,
                    expected = TRUE, 
                    prop.r = FALSE,
                    prop.c = FALSE,
                    prop.t = FALSE,
                    prop.chisq = FALSE,
                    fisher = FALSE,
                    resid = TRUE, 
                    format = c('SPSS'))

assocstats(table(cholestrol,MyData$`Heart condition`))

#4 Heart rate at rest v Heart condition

table4 = CrossTable(heartRate,MyData$`Heart condition`,
                    expected = TRUE, 
                    prop.r = FALSE,
                    prop.c = FALSE,
                    prop.t = FALSE,
                    prop.chisq = FALSE,
                    fisher = FALSE,
                    resid = TRUE, 
                    format = c('SPSS'))

assocstats(table(heartRate,MyData$`Heart condition`))

#5 Heart rate at rest v Heart condition

table5 = CrossTable(MyData$sex,MyData$`Heart condition`,
                    expected = TRUE, 
                    prop.r = FALSE,
                    prop.c = FALSE,
                    prop.t = FALSE,
                    prop.chisq = FALSE,
                    fisher = FALSE,
                    resid = TRUE, 
                    format = c('SPSS'))

assocstats(table(MyData$sex,MyData$`Heart condition`))
